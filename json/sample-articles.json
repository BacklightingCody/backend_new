{
  "articles": [
    {
      "slug": "nestjs-prisma-tutorial",
      "title": "NestJS + Prisma å®Œæ•´å¼€å‘æŒ‡å—ï¼ˆå·²æ›´æ–°ï¼‰",
      "summary": "å­¦ä¹ å¦‚ä½•ä½¿ç”¨NestJSå’ŒPrismaæ„å»ºç°ä»£Webåº”ç”¨ï¼ŒåŒ…å«å®Œæ•´çš„å¼€å‘æµç¨‹å’Œæœ€ä½³å®è·µã€‚",
      "content": "# NestJS + Prisma å¼€å‘æŒ‡å—\n\n![æ¶æ„å›¾](https://images.unsplash.com/photo-1555066931-4365d14bab8c?w=800&h=400)\n\n## ç®€ä»‹\n\n**NestJS** å’Œ **Prisma** æ˜¯æ„å»ºç°ä»£Webåº”ç”¨çš„å¼ºå¤§ç»„åˆã€‚æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªå®Œæ•´çš„åšå®¢ç³»ç»Ÿã€‚\n\n> ğŸ’¡ **æç¤º**ï¼šéœ€è¦åŸºç¡€çš„TypeScriptå’ŒNode.jsçŸ¥è¯†\n\n## ç¯å¢ƒå‡†å¤‡\n\n### ç³»ç»Ÿè¦æ±‚\n\n| å·¥å…· | ç‰ˆæœ¬ | ç”¨é€” |\n|------|------|------|\n| Node.js | >= 18 | è¿è¡Œç¯å¢ƒ |\n| PostgreSQL | >= 13 | æ•°æ®åº“ |\n| Docker | æœ€æ–° | å®¹å™¨åŒ– |\n\n### å¿«é€Ÿå¼€å§‹\n\n```bash\n# åˆ›å»ºé¡¹ç›®\nnpx @nestjs/cli new blog-api\ncd blog-api\n\n# å®‰è£…ä¾èµ–\nnpm install prisma @prisma/client\nnpx prisma init\n```\n\n## æ•°æ®åº“è®¾è®¡\n\n```prisma\nmodel User {\n  id       Int       @id @default(autoincrement())\n  email    String    @unique\n  articles Article[]\n  \n  @@map(\"users\")\n}\n\nmodel Article {\n  id      Int    @id @default(autoincrement())\n  title   String\n  content String @db.Text\n  userId  Int\n  user    User   @relation(fields: [userId], references: [id])\n  \n  @@map(\"articles\")\n}\n```\n\n## æ ¸å¿ƒä»£ç \n\n### Serviceå±‚\n\n```typescript\n@Injectable()\nexport class ArticlesService {\n  constructor(private prisma: PrismaService) {}\n\n  async findAll() {\n    return this.prisma.article.findMany({\n      include: { user: true },\n    });\n  }\n\n  async create(data: CreateArticleDto) {\n    return this.prisma.article.create({ data });\n  }\n}\n```\n\n### Controllerå±‚\n\n```typescript\n@Controller('articles')\nexport class ArticlesController {\n  constructor(private articlesService: ArticlesService) {}\n\n  @Get()\n  findAll() {\n    return this.articlesService.findAll();\n  }\n\n  @Post()\n  create(@Body() createDto: CreateArticleDto) {\n    return this.articlesService.create(createDto);\n  }\n}\n```\n\n## æµ‹è¯•\n\n```typescript\ndescribe('ArticlesService', () => {\n  let service: ArticlesService;\n\n  beforeEach(async () => {\n    const module = await Test.createTestingModule({\n      providers: [ArticlesService, PrismaService],\n    }).compile();\n\n    service = module.get(ArticlesService);\n  });\n\n  it('should create article', async () => {\n    const result = await service.create({\n      title: 'Test',\n      content: 'Content',\n      userId: 1,\n    });\n    expect(result.title).toBe('Test');\n  });\n});\n```\n\n## éƒ¨ç½²\n\n### Dockerfile\n\n```dockerfile\nFROM node:18-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm ci\nCOPY . .\nRUN npm run build\nEXPOSE 3000\nCMD [\"npm\", \"start\"]\n```\n\n### å¯åŠ¨å‘½ä»¤\n\n```bash\n# æ„å»ºé•œåƒ\ndocker build -t blog-api .\n\n# è¿è¡Œå®¹å™¨\ndocker run -p 3000:3000 blog-api\n```\n\n## æœ€ä½³å®è·µ\n\n### 1. é”™è¯¯å¤„ç†\n\n```typescript\n@Injectable()\nexport class PrismaService extends PrismaClient {\n  async onModuleInit() {\n    await this.$connect();\n  }\n\n  async onModuleDestroy() {\n    await this.$disconnect();\n  }\n}\n```\n\n### 2. æ•°æ®éªŒè¯\n\n```typescript\nexport class CreateArticleDto {\n  @IsString()\n  @MinLength(1)\n  title: string;\n\n  @IsString()\n  @MinLength(10)\n  content: string;\n\n  @IsNumber()\n  userId: number;\n}\n```\n\n## æ€§èƒ½ä¼˜åŒ–\n\n### æŸ¥è¯¢ä¼˜åŒ–\n\n```typescript\n// ä½¿ç”¨ç´¢å¼•\n@@index([userId])\n@@index([createdAt])\n\n// æ‰¹é‡æ“ä½œ\nasync createMany(articles: CreateArticleDto[]) {\n  return this.prisma.article.createMany({\n    data: articles,\n    skipDuplicates: true,\n  });\n}\n```\n\n### ç¼“å­˜ç­–ç•¥\n\n```typescript\n@Injectable()\nexport class CacheService {\n  constructor(private redis: RedisService) {}\n\n  async get(key: string) {\n    return this.redis.get(key);\n  }\n\n  async set(key: string, value: any, ttl = 3600) {\n    return this.redis.setex(key, ttl, JSON.stringify(value));\n  }\n}\n```\n\n## ç›‘æ§å’Œæ—¥å¿—\n\n```typescript\n@Injectable()\nexport class LoggerService {\n  private logger = new Logger(LoggerService.name);\n\n  log(message: string, context?: string) {\n    this.logger.log(message, context);\n  }\n\n  error(message: string, trace?: string, context?: string) {\n    this.logger.error(message, trace, context);\n  }\n}\n```\n\n## æ€»ç»“\n\næœ¬æ–‡ä»‹ç»äº†NestJS + Prismaçš„å®Œæ•´å¼€å‘æµç¨‹ï¼š\n\n- âœ… é¡¹ç›®æ­å»ºå’Œé…ç½®\n- âœ… æ•°æ®åº“è®¾è®¡å’Œè¿ç§»\n- âœ… APIå¼€å‘å’Œæµ‹è¯•\n- âœ… éƒ¨ç½²å’Œæ€§èƒ½ä¼˜åŒ–\n\n### åç»­è®¡åˆ’\n\n1. **è®¤è¯æˆæƒ**ï¼šå®ç°JWTè®¤è¯\n2. **æ–‡ä»¶ä¸Šä¼ **ï¼šæ”¯æŒå›¾ç‰‡å’Œæ–‡æ¡£\n3. **å®æ—¶åŠŸèƒ½**ï¼šWebSocketæ”¯æŒ\n4. **APIæ–‡æ¡£**ï¼šSwaggeré›†æˆ\n\n### å­¦ä¹ èµ„æº\n\n- ğŸ“– [NestJSå®˜æ–¹æ–‡æ¡£](https://docs.nestjs.com/)\n- ğŸ“– [Prismaå®˜æ–¹æ–‡æ¡£](https://www.prisma.io/docs/)\n- ğŸ¥ [è§†é¢‘æ•™ç¨‹](https://youtube.com/watch?v=demo)\n- ğŸ’» [æºç ä»“åº“](https://github.com/example/nestjs-blog)\n\n---\n\n**ä½œè€…**ï¼šæŠ€æœ¯å›¢é˜Ÿ  \n**å‘å¸ƒæ—¶é—´**ï¼š2024å¹´8æœˆ23æ—¥  \n**é¢„è®¡é˜…è¯»æ—¶é—´**ï¼š10åˆ†é’Ÿ\n\n---\n\n*æ„Ÿè°¢é˜…è¯»ï¼å¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµæ”¶è—å¹¶åˆ†äº«ç»™æ›´å¤šå¼€å‘è€…ã€‚*",
      "coverImage": "https://images.unsplash.com/photo-1555066931-4365d14bab8c?w=1200&h=600",
      "readTime": 10,
      "tags": [
        "NestJS",
        "Prisma",
        "TypeScript",
        "Node.js",
        "Webå¼€å‘"
      ],
      "category": "åç«¯å¼€å‘",
      "isPublished": true,
      "isDraft": false,
      "viewCount": 856,
      "likes": 72,
      "bookmarks": 38,
      "comments": 15,
      "userId": 1
    }
  ]
}